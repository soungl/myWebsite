---
title: Growth of Entrepreneurial Acitivity in Lakes Region
author: Daniel Lee
date: '2018-05-25'
slug: growth-of-entrepreneurial-acitivity-in-lakes-region
categories:
  - R
tags:
  - R Markdown
---



<div id="import-and-get-a-sense-of-data" class="section level2">
<h2>Import and get a sense of data</h2>
<pre class="r"><code># Import data
data &lt;- read.csv(&quot;data/census2.csv&quot;)

str(data)

summary(data)</code></pre>
</div>
<div id="geofacet" class="section level2">
<h2>Geofacet</h2>
<pre class="r"><code>library(geofacet)
# Create a grid, nh_grid for use of geofacet package
nameTown &lt;- c(&quot;Sandwich&quot;, &quot;Tamworth&quot;, &quot;Freedom&quot;, &quot;Hebron&quot;, &quot;Ashland&quot;, &quot;Holderness&quot;, &quot;Center Harbor&quot;, &quot;Moultonborough&quot;, &quot;Tuftonboro&quot;, &quot;Ossipee&quot;, &quot;Effingham&quot;, &quot;Alexandria&quot;, &quot;Bristol&quot;, &quot;Bridgewater&quot;, &quot;New Hampton&quot;, &quot;Meredith&quot;, &quot;Laconia&quot;, &quot;Gilford&quot;, &quot;Wolfeboro&quot;, &quot;Danbury&quot;, &quot;Hill&quot;, &quot;Sanbornton&quot;, &quot;Belmont&quot;, &quot;Alton&quot;, &quot;Andover&quot;, &quot;Franklin&quot;, &quot;Tilton&quot;, &quot;Gilmanton&quot;, &quot;Northfield&quot;, &quot;Barnstead&quot;)
code &lt;- c(&quot;Sw&quot;, &quot;Tw&quot;, &quot;Fd&quot;, &quot;Hb&quot;, &quot;Al&quot;, &quot;Hn&quot;, &quot;Ch&quot;, &quot;Mb&quot;, &quot;Tb&quot;, &quot;Op&quot;, &quot;Eh&quot;, &quot;Ad&quot;, &quot;Bt&quot;, &quot;Bw&quot;, &quot;Nh&quot;, &quot;Md&quot;, &quot;Ln&quot;, &quot;Gf&quot;, &quot;Wb&quot;, &quot;Db&quot;, &quot;Hl&quot;, &quot;Sb&quot;, &quot;Bm&quot;, &quot;At&quot;, &quot;Av&quot;, &quot;Fk&quot;, &quot;Tt&quot;, &quot;Gm&quot;, &quot;Nf&quot;, &quot;Bs&quot;)
row &lt;- c(1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,4,3,3,4,4,4,5,4,5,5,5,5,6,6)
col &lt;- c(6,7,9,1,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,1,2,4,6,8,2,3,4,7,4,8)
nh_grid &lt;- data.frame(nameTown, code, row, col)

data_geo &lt;- data
colnames(data_geo)[colnames(data_geo) == &quot;Town&quot;] &lt;- &quot;nameTown&quot;

library(dplyr)
library(ggplot2)
library(tidyr)

data %&gt;%
  select(Town, incomeLabor_SelfEmpl, Year, benchM) %&gt;%
  mutate(Year = paste0(&quot;Yr&quot;,Year)) %&gt;%
  spread(Year, incomeLabor_SelfEmpl) %&gt;%
  ggplot(aes(reorder(x = Town, (Yr2016-Yr2011)/Yr2011), y = (Yr2016-Yr2011)/Yr2011, fill = benchM)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  labs(title = &quot;Percent Change in Self-Employment Income between 2007-11 and 2012-16&quot;,
       x = NULL,
       y = &quot;Percent Change in Income&quot;)</code></pre>
<p><img src="/post/2018-05-24-economic-and-demographic-trends-in-lakes-region_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="percent-change-by-geofacet" class="section level2">
<h2>Percent change by geofacet</h2>
<pre class="r"><code>library(stringr)
data_geo %&gt;%
  filter(!nameTown %in% c(&quot;United States&quot;, &quot;New Hampshire&quot;)) %&gt;%
  select(nameTown, incomeLabor_SelfEmpl, incomeLabor_WageSalary, Year) %&gt;%
  mutate(Year = paste0(&quot;Yr&quot;,Year),) %&gt;%
  gather(var, value, c(&quot;incomeLabor_SelfEmpl&quot;, &quot;incomeLabor_WageSalary&quot;)) %&gt;%
  mutate(var = str_extract(var, &quot;Self|Wage&quot;)) %&gt;% #change the text for shorter axis text in graph
  spread(Year, value)  %&gt;%
  ggplot(aes(x = var, y = (Yr2016-Yr2011)/Yr2011, fill = Yr2016-Yr2011 &gt; 0)) + 
  geom_col() +
  facet_geo(~ nameTown, grid = nh_grid) +
  labs(title = &quot;Percent Changes in Income between 2007-11 and 2012-16&quot;,
       x = NULL,
       y = NULL,
       caption = &quot;Data source: American Community Survey, 5-year estimate&quot;) +
  theme(axis.ticks.x=element_blank(),
        legend.position= c(0,0.05),
        legend.title=element_blank()) + 
  scale_fill_discrete(labels=c(&quot;Decrease&quot;, &quot;Increase&quot;))</code></pre>
<p><img src="/post/2018-05-24-economic-and-demographic-trends-in-lakes-region_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
